<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>时间线</title>
<link href="css/lineStyle.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../jquery.min.js"></script>
<script type="text/javascript" src="params.js"></script>
<script type="text/javascript">
	function parseDom(year, content) {
		var dStr = [];
		dStr.push('<div class="year">');
		dStr.push('<h2>');
		dStr.push('<a href="#">' + year + '<i></i></a>');
		dStr.push('</h2>');
		dStr.push('<div class="list">');
		dStr.push('<ul>');
		for (i in content) {
			for (j in content[i].contents) {
				var cs = content[i].contents[j];
				dStr.push('<li class="cls">');
				dStr.push('<p class="date">' + content[i].date + '</p>');
				dStr.push('<p class="intro">' + cs.weather + '</p>');
				dStr.push('<p class="version">' + cs.location + '</p>');
				dStr.push('<p class="version">' + cs.locationDetail + '</p>');
				dStr.push('<div class="more">');
				if (cs.note) {
					dStr.push('<p>' + cs.note + '</p>');
				}
				if (cs.imgPaths) {
					var imgStr = '<p>';
					var len = 0;
					for (img in cs.imgPaths) {
						imgStr += '<img src="file:///' + cs.imgPaths[img] + '" height="100"/>';
						if (++len > 5) {
							imgStr += '<strong>...</strong>';
							break;
						}
					}
					imgStr += '</p>';
					dStr.push(imgStr);
				}
				dStr.push('</div>');
				dStr.push('</li>');
			}
		}
		dStr.push('</ul>');
		dStr.push('</div>');
		dStr.push('</div>');
		var html = dStr.join('');
		return html;
	}
	$(document).ready(function() {
		for (v in params) {
			var xmlDoc = parseDom(v, params[v]);
			$('#content').append(xmlDoc);
		}
		$(".main .year .list").each(function(e, target) {
			var $target = $(target), $ul = $target.find("ul");
			$target.height($ul.outerHeight()), $ul.css("position", "absolute");
		});
		$(".main .year>h2>a").click(function(e) {
			e.preventDefault();
			$(this).parents(".year").toggleClass("close");
		});
	});
</script>
</head>
<body>
	<div class="content">
		<div class="wrapper">
			<div class="light">
				<i></i>
			</div>
			<hr class="line-left">
			<hr class="line-right">
			<div class="main" id="content">
				<h1 class="title">XX与XX的相遇日记</h1>
			</div>
		</div>
		<div class="footer">
			<div class="footer-content clearfix">
				<div class="copyright">Copyright © 2011-2014 All Rights
					Reserved</div>
			</div>
		</div>
</body>
</html>